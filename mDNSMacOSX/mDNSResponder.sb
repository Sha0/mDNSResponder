version "0.4beta";
#dem default;
#dem-server com.apple.seatbelt.learner;

#deny default;
signal FPE default;

# Autogenerated profile, please double check
allow net UNIX;
allow net_inbound;
allow net_outbound;
allow net_accept;

allow sysctl_ro;

allow fs_read_mdata;

allow fs_read_data -regex "^/usr/sbin\$";
allow fs_read_data -regex "^/dev/urandom\$";
allow fs_read_data -regex "^/private/var/db/dyld/dyld_shared_cache_i386\$";
allow fs_read_data -regex "^/System/Library/Security\$";
allow fs_read_data -regex "^[rxsafe "/usr/lib/libSystem.B.dylib"]\$";
allow fs_read_data -regex "^[rxsafe "/System/Library/CoreServices/SystemVersion.plist"]\$";
allow fs_read_data -regex "^[rxsafe "/System/Library/CoreServices/SystemVersion.bundle"]\$";
allow fs_read_data -regex "^[rxsafe "/System/Library/CoreServices/SystemVersion.bundle/English.lproj"]\$";
allow fs_read_data -regex "^[rxsafe "/System/Library/CoreServices/SystemVersion.bundle/English.lproj/SystemVersion.strings"]\$";
allow fs_read_data -regex "^[rxsafe "/Library/Preferences/.GlobalPreferences.plist"]\$";
allow fs_read_data -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist"]\$";
allow fs_read_data -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist-new"]\$";
allow fs_read_data -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist/preferences.plist"]\$";
allow fs_read_data -regex "^[rxsafe "/Library/Keychains/System.keychain"]\$";
allow fs_read_data -regex "^[rxsafe "/private/var/root/Library/Preferences/ByHost/.GlobalPreferences.0017f2268278.plist"]\$";
allow fs_read_data -regex "^[rxsafe "/private/var/root/Library/Preferences/.GlobalPreferences.plist"]\$";
allow fs_read_data -regex "^[rxsafe "/private/var/tmp/mds/system/mdsObject.db"]\$";
allow fs_read_data -regex "^[rxsafe "/private/var/tmp/mds/system/mdsDirectory.db"]\$";

allow fs_read_sdata -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist-new"]\$";
allow fs_read_sdata -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist/preferences.plist"]\$";

allow fs_write -regex "^[rxsafe "/private/var/run/mDNSResponder.pid"]\$";
allow fs_write -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist-new"]\$";
allow fs_write -regex "^/private/var/run/mDNSResponder\$";

allow fs_write_data -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist-new"]\$";
allow fs_write_data -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist/preferences.plist"]\$";
allow fs_write_data -regex "^[rxsafe "/private/var/tmp/mds/system/mds.lock"]\$";

allow fs_write_mdata -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist-new"]\$";
allow fs_write_mdata -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist/preferences.plist"]\$";

allow fs_write_sdata_flags -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist-new"]\$";
allow fs_write_sdata -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist-new"]\$";
allow fs_write_sdata -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist/preferences.plist"]\$";
allow fs_write_sdata_flags -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist/preferences.plist"]\$";
allow fs_write_sdata_esclation -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist-new"]\$";
allow fs_write_sdata_esclation -regex "^[rxsafe "/Library/Preferences/SystemConfiguration/preferences.plist/preferences.plist"]\$";
